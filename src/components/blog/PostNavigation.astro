---
import { getTranslations, type Locale, getLocalizedPath } from '../../utils/i18n';
import type { CollectionEntry } from 'astro:content';

interface Props {
  previous: CollectionEntry<'notes'> | null;
  next: CollectionEntry<'notes'> | null;
  locale: Locale;
}

const { previous, next, locale } = Astro.props;
const t = getTranslations(locale);

function getPostUrl(slug: string, locale: Locale): string {
  const baseSlug = slug.replace(/\/id$|\/en$/, '');
  return getLocalizedPath(`/notes/${baseSlug}`, locale);
}
---

{
  (previous || next) && (
    <nav
      class="my-8 border-t border-gray-200 pt-8 dark:border-gray-700"
      aria-label="Post navigation"
    >
      <div class="grid gap-4 md:grid-cols-2">
        {previous ? (
          <a
            href={getPostUrl(previous.slug, locale)}
            class="group flex flex-col rounded-lg border border-gray-200 bg-white p-4 transition-colors hover:border-gray-300 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700"
          >
            <div class="mb-2 text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">
              ← {t.navigation.previousPost}
            </div>
            <div class="text-base font-semibold text-gray-900 group-hover:text-blue-600 dark:text-gray-100 dark:group-hover:text-blue-400">
              {previous.data.title}
            </div>
          </a>
        ) : (
          <div class="flex flex-col rounded-lg border border-gray-200 bg-gray-50 p-4 opacity-50 dark:border-gray-700 dark:bg-gray-900">
            <div class="mb-2 text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">
              ← {t.navigation.previousPost}
            </div>
            <div class="text-sm text-gray-500 dark:text-gray-400">{t.navigation.noPrevious}</div>
          </div>
        )}

        {next ? (
          <a
            href={getPostUrl(next.slug, locale)}
            class="group flex flex-col rounded-lg border border-gray-200 bg-white p-4 text-right transition-colors hover:border-gray-300 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600 dark:hover:bg-gray-700"
          >
            <div class="mb-2 text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">
              {t.navigation.nextPost} →
            </div>
            <div class="text-base font-semibold text-gray-900 group-hover:text-blue-600 dark:text-gray-100 dark:group-hover:text-blue-400">
              {next.data.title}
            </div>
          </a>
        ) : (
          <div class="flex flex-col rounded-lg border border-gray-200 bg-gray-50 p-4 text-right opacity-50 dark:border-gray-700 dark:bg-gray-900">
            <div class="mb-2 text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">
              {t.navigation.nextPost} →
            </div>
            <div class="text-sm text-gray-500 dark:text-gray-400">{t.navigation.noNext}</div>
          </div>
        )}
      </div>
    </nav>
  )
}
