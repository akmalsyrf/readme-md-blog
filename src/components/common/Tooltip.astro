---
interface Props {
  title: string;
  description: string;
  formula: string;
  explanation: string;
  position?: 'left' | 'center' | 'right';
}

const { title, description, formula, explanation, position = 'center' } = Astro.props;

const positionClasses = {
  left: 'left-0',
  center: 'left-1/2 -translate-x-1/2',
  right: 'right-0',
};

const arrowPositionClasses = {
  left: 'left-6',
  center: 'left-1/2 -translate-x-1/2',
  right: 'right-6',
};
---

<div class="group relative inline-block w-full">
  <slot />
  <div
    class={`tooltip invisible absolute bottom-full z-10 mb-2 w-80 rounded-lg bg-gray-900 p-4 text-sm text-white opacity-0 shadow-lg transition-opacity group-hover:visible group-hover:opacity-100 dark:bg-gray-800 ${positionClasses[position]}`}
  >
    <div class="mb-2 font-semibold">{title}</div>
    <div class="mb-2 text-gray-300">{description}</div>
    <div class="mb-2 break-all rounded bg-gray-700 p-2 font-mono text-xs">
      {formula}
    </div>
    <div class="text-xs text-gray-400">{explanation}</div>
    <div
      class={`absolute top-full border-4 border-transparent border-t-gray-900 dark:border-t-gray-800 ${arrowPositionClasses[position]}`}
    >
    </div>
  </div>
</div>

<style>
  .tooltip {
    pointer-events: none;
  }

  .group:hover .tooltip {
    pointer-events: auto;
  }

  @media (max-width: 1024px) {
    .tooltip {
      width: calc(100vw - 2rem) !important;
      max-width: 320px !important;
    }
  }

  @media (max-width: 768px) {
    .tooltip {
      left: 0 !important;
      right: auto !important;
      transform: none !important;
      width: calc(100vw - 2rem) !important;
      max-width: 320px !important;
    }
  }
</style>
